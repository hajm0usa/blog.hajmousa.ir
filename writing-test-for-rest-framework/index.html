<!doctype html>
<html class="not-ready lg:text-base overflow-y-scroll scroll-pt-14 scheme-light dark:scheme-dark" lang="en">

<head prefix="og: https://ogp.me/ns# article: https://ogp.me/ns/article#">
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="generator" content="Zola v0.21.0" />
  <title>Guide to Writing Tests for APIs in Django REST Framework | HajMousa;s DevBlog</title>
  <meta property="og:site_name" content="HajMousa;s DevBlog" />
  <meta property="og:title" content="Guide to Writing Tests for APIs in Django REST Framework" />
  <meta property="og:url" content="https://blog.hajmousa.ir/writing-test-for-rest-framework/" />
  <link rel="canonical" href="https://blog.hajmousa.ir/writing-test-for-rest-framework/" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-12-17T00:00:00+00:00" />
  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed" />
  <!-- Begin Head inject -->
  
  <!-- End Head inject -->
  <link rel="stylesheet" href="https://blog.hajmousa.ir/main.min.css?h=80ece4d015818ae93fff" />
  <link rel="stylesheet" href="https://blog.hajmousa.ir/icons.css?h=7dd5ab449fa840fc01e2" />
  <style>:root{--bg: #f4f4f5; --header: #e4e4e7;} :root.dark{--bg: #18181b; --header: #27272a;}</style>
  <link rel="icon" type="image/x-icon" href="https://blog.hajmousa.ir/favicon.ico" />
  <link rel="apple-touch-icon" type="image/png" href="https://blog.hajmousa.ir/apple-touch-icon.png?h=58bee300054c5308feb3" />
  <link rel="icon" type="image/png" href="https://blog.hajmousa.ir/android-icon.png?h=8d80ec95446bd2c36826" />
  <script src="https://blog.hajmousa.ir/js/zola-theme.min.js?h=26975b146d48e6ff41af"></script>
  <!-- Begin Head End inject -->
  
  <!-- End Head End inject -->
</head>

<body class="text-black duration-100 ease-out dark:text-white">
  <!-- Header -->
<header class="blur-header fixed top-0 z-40 mx-auto min-h-13 w-full">
  <div class="mx-auto w-full max-w-4xl p-2.5 lg:flex lg:justify-between">
    <div class="flex justify-between">
      <div class="flex items-center min-h-8 overflow-hidden">
        <a title="Go to home page [Alt + !]" accesskey="!"
          href="https://blog.hajmousa.ir/"
          class="text-2xl font-semibold truncate">HajMousa;s DevBlog</a>
        <button type="button" title="Switch color scheme [Alt + $]" accesskey="$"
          onclick="window.zolaTheme.color.toggle();"
          class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0px]
            bg-center bg-no-repeat bg-cover [background-image:var(--icons-btn-dark,url(icons/btn-dark.svg))]
            dark:[background-image:var(--icons-btn-light,url(icons/btn-light.svg))] dark:invert"
        ></button>
        <button type="button" title="Open search [Alt + /]" accesskey="/"
          onclick="window.zolaTheme.search.toggle();"
          class="btn-search ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0px]
            bg-center bg-no-repeat bg-cover [background-image:var(--icons-search,url(icons/search.svg))] dark:invert"
        ></button>
      </div>
    </div>
  </div>
</header>

  <!-- Begin Body Start inject -->
  
  <!-- End Body Start inject -->
  <main class="prose prose-neutral dark:prose-invert prose-pre:rounded-lg prose-img:rounded-lg
    relative mx-auto min-h-[calc(100vh-4rem)] max-w-3xl px-4 pt-28 lg:pt-32 pb-12 wrap-break-word">
      <!-- Search -->
<div id="linkita-search-wrapper" class="hidden">
  <ul id="linkita-search-results"></ul>
</div>
<script>window.zolaTheme.search.init({ scripts: ["https://blog.hajmousa.ir/elasticlunr.min.js", "https://blog.hajmousa.ir/search_index.en.js"], arg: { w: "#linkita-search-wrapper", r: "#linkita-search-results" } });</script>

    
<article>
  <!-- Begin Page Start inject -->
  
  <!-- End Page Start inject -->

  <header class="mb-16">
    <h1 class="my-0! pb-2.5">Guide to Writing Tests for APIs in Django REST Framework</h1>
    <!-- Page Info -->
<div class="text-sm antialiased opacity-80"><time
      datetime="2025-12-17T00:00:00+00:00">2025-12-17</time><span
        class="middot"></span><time
    datetime="PT0H2M0S">2&nbsp;min</time><span
      class="middot"></span>
</div>

  </header>
  <!-- TOC -->
<nav class="block-bg prose-a:secondary-link mb-12 rounded-lg p-2 text-lg">
  <details>
    <summary class="select-none py-0.5 lg:py-1 pl-3.5" title="[Alt + =]" accesskey="=">
      <span class="cursor-pointer ml-0.5">Table of Contents</span>
    </summary>
    <ul class="ps-8">
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#introduction">Introduction</a>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#table-of-contents">Table of Contents</a>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#1-setting-up-your-test-environment">1. Setting Up Your Test Environment</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#basic-test-structure">Basic Test Structure</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#key-testing-classes">Key Testing Classes</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#2-test-classes-and-methods">2. Test Classes and Methods</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#using-apitestcase">Using APITestCase</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#using-apiclient">Using APIClient</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#3-testing-api-endpoints">3. Testing API Endpoints</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-get-requests">Testing GET Requests</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-post-requests">Testing POST Requests</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-put-patch-requests">Testing PUT&#x2F;PATCH Requests</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-delete-requests">Testing DELETE Requests</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#4-authentication-and-permissions-testing">4. Authentication and Permissions Testing</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-with-token-authentication">Testing with Token Authentication</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-with-jwt-authentication">Testing with JWT Authentication</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-session-authentication">Testing Session Authentication</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-permissions">Testing Permissions</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#5-testing-serializers">5. Testing Serializers</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#basic-serializer-tests">Basic Serializer Tests</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-nested-serializers">Testing Nested Serializers</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#6-testing-viewsets-and-views">6. Testing ViewSets and Views</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-viewsets">Testing ViewSets</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-custom-actions">Testing Custom Actions</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#7-advanced-testing-techniques">7. Advanced Testing Techniques</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-pagination">Testing Pagination</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-filtering-and-search">Testing Filtering and Search</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-ordering">Testing Ordering</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-file-uploads">Testing File Uploads</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-rate-limiting">Testing Rate Limiting</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#using-mocks">Using Mocks</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#8-best-practices">8. Best Practices</a>
        <ul>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#organization">Organization</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#use-factories-for-test-data">Use Factories for Test Data</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#test-coverage">Test Coverage</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#common-assertions">Common Assertions</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#testing-edge-cases">Testing Edge Cases</a>
          </li>
          <li class="ps-0.5">
            <a class="no-underline hover:underline" href="#running-tests">Running Tests</a>
          </li>
        </ul>
      </li>
      <li class="ps-0.5">
        <a class="no-underline hover:underline" href="#conclusion">Conclusion</a>
      </li>
    </ul>
  </details>
</nav>

  <!-- Content -->
  <section><h2 id="introduction">Introduction</h2>
<p>Testing is a crucial part of developing robust APIs. Django REST Framework (DRF) provides excellent tools for testing your API endpoints. This guide covers everything from basic tests to advanced testing strategies.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li>Setting Up Your Test Environment</li>
<li>Test Classes and Methods</li>
<li>Testing API Endpoints</li>
<li>Authentication and Permissions Testing</li>
<li>Testing Serializers</li>
<li>Testing ViewSets and Views</li>
<li>Advanced Testing Techniques</li>
<li>Best Practices</li>
</ol>
<h2 id="1-setting-up-your-test-environment">1. Setting Up Your Test Environment</h2>
<h3 id="basic-test-structure">Basic Test Structure</h3>
<p>Django REST Framework builds on Django's testing framework. Create a <code>tests.py</code> file in your app directory or organize tests in a <code>tests/</code> folder.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework.test </span><span style="color:#b48ead;">import </span><span>APITestCase, APIClient
</span><span style="color:#b48ead;">from </span><span>rest_framework </span><span style="color:#b48ead;">import </span><span>status
</span><span style="color:#b48ead;">from </span><span>django.contrib.auth.models </span><span style="color:#b48ead;">import </span><span>User
</span><span style="color:#b48ead;">from .</span><span>models </span><span style="color:#b48ead;">import </span><span>YourModel
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">YourAPITestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Set up test data that will be used across multiple tests&quot;&quot;&quot;
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client = </span><span style="color:#bf616a;">APIClient</span><span>()
</span><span>        </span><span style="color:#bf616a;">self</span><span>.user = User.objects.</span><span style="color:#bf616a;">create_user</span><span>(
</span><span>            </span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">testuser</span><span>&#39;,
</span><span>            </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">testpass123</span><span>&#39;
</span><span>        )
</span></code></pre>
<h3 id="key-testing-classes">Key Testing Classes</h3>
<ul>
<li><strong>APITestCase</strong>: Extends Django's <code>TransactionTestCase</code>, provides API-specific assertions</li>
<li><strong>APIClient</strong>: Enhanced client for making API requests</li>
<li><strong>APIRequestFactory</strong>: For testing views directly without going through URL routing</li>
</ul>
<h2 id="2-test-classes-and-methods">2. Test Classes and Methods</h2>
<h3 id="using-apitestcase">Using APITestCase</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework.test </span><span style="color:#b48ead;">import </span><span>APITestCase
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">ProductAPITestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Runs before each test method&quot;&quot;&quot;
</span><span>        </span><span style="color:#bf616a;">self</span><span>.user = User.objects.</span><span style="color:#bf616a;">create_user</span><span>(</span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">test</span><span>&#39;, </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">pass</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.product = Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Test Product</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">100</span><span>)
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">tearDown</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Runs after each test method (optional)&quot;&quot;&quot;
</span><span>        </span><span style="color:#b48ead;">pass
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_something</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Each test method must start with &#39;test_&#39;&quot;&quot;&quot;
</span><span>        </span><span style="color:#b48ead;">pass
</span></code></pre>
<h3 id="using-apiclient">Using APIClient</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework.test </span><span style="color:#b48ead;">import </span><span>APIClient
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">TestViews</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client = </span><span style="color:#bf616a;">APIClient</span><span>()
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_with_client</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/products/</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, </span><span style="color:#d08770;">200</span><span>)
</span></code></pre>
<h2 id="3-testing-api-endpoints">3. Testing API Endpoints</h2>
<h3 id="testing-get-requests">Testing GET Requests</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_get_product_list</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test retrieving a list of products&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)  </span><span style="color:#65737e;"># Using named URL patterns
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), Product.objects.</span><span style="color:#bf616a;">count</span><span>())
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_get_product_detail</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test retrieving a single product&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.product.pk})
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], </span><span style="color:#bf616a;">self</span><span>.product.name)
</span></code></pre>
<h3 id="testing-post-requests">Testing POST Requests</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_create_product</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test creating a new product&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    data = {
</span><span>        &#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">New Product</span><span>&#39;,
</span><span>        &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">150.00</span><span>,
</span><span>        &#39;</span><span style="color:#a3be8c;">description</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">A new test product</span><span>&#39;
</span><span>    }
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, data, </span><span style="color:#bf616a;">format</span><span>=&#39;</span><span style="color:#a3be8c;">json</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_201_CREATED</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(Product.objects.</span><span style="color:#bf616a;">count</span><span>(), </span><span style="color:#d08770;">2</span><span>)  </span><span style="color:#65737e;"># 1 from setUp + 1 new
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], &#39;</span><span style="color:#a3be8c;">New Product</span><span>&#39;)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_create_product_invalid_data</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test creating a product with invalid data&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    data = {&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;&#39;}  </span><span style="color:#65737e;"># Missing required fields
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, data, </span><span style="color:#bf616a;">format</span><span>=&#39;</span><span style="color:#a3be8c;">json</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_400_BAD_REQUEST</span><span>)
</span></code></pre>
<h3 id="testing-put-patch-requests">Testing PUT/PATCH Requests</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_update_product_put</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test full update of a product&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.product.pk})
</span><span>    data = {
</span><span>        &#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Updated Product</span><span>&#39;,
</span><span>        &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">200.00</span><span>,
</span><span>        &#39;</span><span style="color:#a3be8c;">description</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Updated description</span><span>&#39;
</span><span>    }
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">put</span><span>(url, data, </span><span style="color:#bf616a;">format</span><span>=&#39;</span><span style="color:#a3be8c;">json</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.product.</span><span style="color:#bf616a;">refresh_from_db</span><span>()
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#bf616a;">self</span><span>.product.name, &#39;</span><span style="color:#a3be8c;">Updated Product</span><span>&#39;)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_update_product_patch</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test partial update of a product&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.product.pk})
</span><span>    data = {&#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">250.00</span><span>}
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">patch</span><span>(url, data, </span><span style="color:#bf616a;">format</span><span>=&#39;</span><span style="color:#a3be8c;">json</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.product.</span><span style="color:#bf616a;">refresh_from_db</span><span>()
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#bf616a;">self</span><span>.product.price, </span><span style="color:#d08770;">250.00</span><span>)
</span></code></pre>
<h3 id="testing-delete-requests">Testing DELETE Requests</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_delete_product</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test deleting a product&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.product.pk})
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">delete</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_204_NO_CONTENT</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(Product.objects.</span><span style="color:#bf616a;">count</span><span>(), </span><span style="color:#d08770;">0</span><span>)
</span></code></pre>
<h2 id="4-authentication-and-permissions-testing">4. Authentication and Permissions Testing</h2>
<h3 id="testing-with-token-authentication">Testing with Token Authentication</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework.authtoken.models </span><span style="color:#b48ead;">import </span><span>Token
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">AuthenticatedAPITestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.user = User.objects.</span><span style="color:#bf616a;">create_user</span><span>(</span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">test</span><span>&#39;, </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">pass</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.token = Token.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">user</span><span>=</span><span style="color:#bf616a;">self</span><span>.user)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client = </span><span style="color:#bf616a;">APIClient</span><span>()
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_authenticated_request</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test API access with token authentication&quot;&quot;&quot;
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">credentials</span><span>(</span><span style="color:#bf616a;">HTTP_AUTHORIZATION</span><span>=&#39;</span><span style="color:#a3be8c;">Token </span><span>&#39; + </span><span style="color:#bf616a;">self</span><span>.token.key)
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/protected-endpoint/</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_unauthenticated_request</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test API access without authentication&quot;&quot;&quot;
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/protected-endpoint/</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_401_UNAUTHORIZED</span><span>)
</span></code></pre>
<h3 id="testing-with-jwt-authentication">Testing with JWT Authentication</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework_simplejwt.tokens </span><span style="color:#b48ead;">import </span><span>RefreshToken
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">JWTAuthTestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.user = User.objects.</span><span style="color:#bf616a;">create_user</span><span>(</span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">test</span><span>&#39;, </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">pass</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client = </span><span style="color:#bf616a;">APIClient</span><span>()
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_jwt_authenticated_request</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test API access with JWT token&quot;&quot;&quot;
</span><span>        refresh = RefreshToken.</span><span style="color:#bf616a;">for_user</span><span>(</span><span style="color:#bf616a;">self</span><span>.user)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">credentials</span><span>(</span><span style="color:#bf616a;">HTTP_AUTHORIZATION</span><span>=</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">Bearer </span><span>{refresh.access_token}&#39;)
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/protected-endpoint/</span><span>&#39;)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span></code></pre>
<h3 id="testing-session-authentication">Testing Session Authentication</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_session_authenticated_request</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API access with session authentication&quot;&quot;&quot;
</span><span>    </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">login</span><span>(</span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">test</span><span>&#39;, </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">pass</span><span>&#39;)
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/protected-endpoint/</span><span>&#39;)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">logout</span><span>()
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/protected-endpoint/</span><span>&#39;)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_401_UNAUTHORIZED</span><span>)
</span></code></pre>
<h3 id="testing-permissions">Testing Permissions</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_owner_can_update</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test that only the owner can update their resource&quot;&quot;&quot;
</span><span>    </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">force_authenticate</span><span>(</span><span style="color:#bf616a;">user</span><span>=</span><span style="color:#bf616a;">self</span><span>.user)
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">post-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.user_post.pk})
</span><span>    data = {&#39;</span><span style="color:#a3be8c;">title</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Updated Title</span><span>&#39;}
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">patch</span><span>(url, data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_non_owner_cannot_update</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test that non-owners cannot update resources&quot;&quot;&quot;
</span><span>    other_user = User.objects.</span><span style="color:#bf616a;">create_user</span><span>(</span><span style="color:#bf616a;">username</span><span>=&#39;</span><span style="color:#a3be8c;">other</span><span>&#39;, </span><span style="color:#bf616a;">password</span><span>=&#39;</span><span style="color:#a3be8c;">pass</span><span>&#39;)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">force_authenticate</span><span>(</span><span style="color:#bf616a;">user</span><span>=other_user)
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">post-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#bf616a;">self</span><span>.user_post.pk})
</span><span>    data = {&#39;</span><span style="color:#a3be8c;">title</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Hacked Title</span><span>&#39;}
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">patch</span><span>(url, data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_403_FORBIDDEN</span><span>)
</span></code></pre>
<h2 id="5-testing-serializers">5. Testing Serializers</h2>
<h3 id="basic-serializer-tests">Basic Serializer Tests</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from .</span><span>serializers </span><span style="color:#b48ead;">import </span><span>ProductSerializer
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">ProductSerializerTestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.product_data = {
</span><span>            &#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Test Product</span><span>&#39;,
</span><span>            &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">100.00</span><span>,
</span><span>            &#39;</span><span style="color:#a3be8c;">description</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Test description</span><span>&#39;
</span><span>        }
</span><span>        </span><span style="color:#bf616a;">self</span><span>.product = Product.objects.</span><span style="color:#bf616a;">create</span><span>(**</span><span style="color:#bf616a;">self</span><span>.product_data)
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_serializer_with_valid_data</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test serializer with valid data&quot;&quot;&quot;
</span><span>        serializer = </span><span style="color:#bf616a;">ProductSerializer</span><span>(</span><span style="color:#bf616a;">data</span><span>=</span><span style="color:#bf616a;">self</span><span>.product_data)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertTrue</span><span>(serializer.</span><span style="color:#bf616a;">is_valid</span><span>())
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_serializer_with_invalid_data</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test serializer with invalid data&quot;&quot;&quot;
</span><span>        invalid_data = {&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;&#39;, &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: -</span><span style="color:#d08770;">10</span><span>}
</span><span>        serializer = </span><span style="color:#bf616a;">ProductSerializer</span><span>(</span><span style="color:#bf616a;">data</span><span>=invalid_data)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertFalse</span><span>(serializer.</span><span style="color:#bf616a;">is_valid</span><span>())
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;, serializer.errors)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">price</span><span>&#39;, serializer.errors)
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_serializer_output</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test serializer output contains expected fields&quot;&quot;&quot;
</span><span>        serializer = </span><span style="color:#bf616a;">ProductSerializer</span><span>(</span><span style="color:#bf616a;">instance</span><span>=</span><span style="color:#bf616a;">self</span><span>.product)
</span><span>        data = serializer.data
</span><span>        
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#bf616a;">set</span><span>(data.</span><span style="color:#bf616a;">keys</span><span>()), {&#39;</span><span style="color:#a3be8c;">id</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">name</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">description</span><span>&#39;})
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(data[&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], &#39;</span><span style="color:#a3be8c;">Test Product</span><span>&#39;)
</span></code></pre>
<h3 id="testing-nested-serializers">Testing Nested Serializers</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_nested_serializer</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test serializer with nested relationships&quot;&quot;&quot;
</span><span>    category = Category.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Electronics</span><span>&#39;)
</span><span>    product = Product.objects.</span><span style="color:#bf616a;">create</span><span>(
</span><span>        </span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Laptop</span><span>&#39;,
</span><span>        </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">1000</span><span>,
</span><span>        </span><span style="color:#bf616a;">category</span><span>=category
</span><span>    )
</span><span>    
</span><span>    serializer = </span><span style="color:#bf616a;">ProductSerializer</span><span>(</span><span style="color:#bf616a;">instance</span><span>=product)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(serializer.data[&#39;</span><span style="color:#a3be8c;">category</span><span>&#39;][&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], &#39;</span><span style="color:#a3be8c;">Electronics</span><span>&#39;)
</span></code></pre>
<h2 id="6-testing-viewsets-and-views">6. Testing ViewSets and Views</h2>
<h3 id="testing-viewsets">Testing ViewSets</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>rest_framework.test </span><span style="color:#b48ead;">import </span><span>APIRequestFactory
</span><span style="color:#b48ead;">from .</span><span>views </span><span style="color:#b48ead;">import </span><span>ProductViewSet
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">ProductViewSetTestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">setUp</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.factory = </span><span style="color:#bf616a;">APIRequestFactory</span><span>()
</span><span>        </span><span style="color:#bf616a;">self</span><span>.view = ProductViewSet.</span><span style="color:#bf616a;">as_view</span><span>({&#39;</span><span style="color:#a3be8c;">get</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">list</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">post</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">create</span><span>&#39;})
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_viewset_list</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test viewset list action&quot;&quot;&quot;
</span><span>        request = </span><span style="color:#bf616a;">self</span><span>.factory.</span><span style="color:#bf616a;">get</span><span>(&#39;</span><span style="color:#a3be8c;">/api/products/</span><span>&#39;)
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">view</span><span>(request)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_viewset_create</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test viewset create action&quot;&quot;&quot;
</span><span>        data = {&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">New Product</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">100</span><span>}
</span><span>        request = </span><span style="color:#bf616a;">self</span><span>.factory.</span><span style="color:#bf616a;">post</span><span>(&#39;</span><span style="color:#a3be8c;">/api/products/</span><span>&#39;, data)
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">view</span><span>(request)
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_201_CREATED</span><span>)
</span></code></pre>
<h3 id="testing-custom-actions">Testing Custom Actions</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_custom_action</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test custom viewset action&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-featured</span><span>&#39;)  </span><span style="color:#65737e;"># Custom action route
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    
</span><span>    </span><span style="color:#65737e;"># Verify all returned products are featured
</span><span>    </span><span style="color:#b48ead;">for </span><span>product </span><span style="color:#b48ead;">in </span><span>response.data:
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertTrue</span><span>(product[&#39;</span><span style="color:#a3be8c;">is_featured</span><span>&#39;])
</span></code></pre>
<h2 id="7-advanced-testing-techniques">7. Advanced Testing Techniques</h2>
<h3 id="testing-pagination">Testing Pagination</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_pagination</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API pagination&quot;&quot;&quot;
</span><span>    </span><span style="color:#65737e;"># Create multiple products
</span><span>    </span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(</span><span style="color:#d08770;">15</span><span>):
</span><span>        Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">Product </span><span>{i}&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">100</span><span>)
</span><span>    
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">results</span><span>&#39;, response.data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">count</span><span>&#39;, response.data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">next</span><span>&#39;, response.data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">results</span><span>&#39;]), </span><span style="color:#d08770;">10</span><span>)  </span><span style="color:#65737e;"># Default page size
</span></code></pre>
<h3 id="testing-filtering-and-search">Testing Filtering and Search</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_filtering</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API filtering&quot;&quot;&quot;
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Laptop</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">1000</span><span>, </span><span style="color:#bf616a;">category</span><span>=&#39;</span><span style="color:#a3be8c;">Electronics</span><span>&#39;)
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Book</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">20</span><span>, </span><span style="color:#bf616a;">category</span><span>=&#39;</span><span style="color:#a3be8c;">Books</span><span>&#39;)
</span><span>    
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;) + &#39;</span><span style="color:#a3be8c;">?category=Electronics</span><span>&#39;
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), </span><span style="color:#d08770;">1</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[</span><span style="color:#d08770;">0</span><span>][&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], &#39;</span><span style="color:#a3be8c;">Laptop</span><span>&#39;)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_search</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API search functionality&quot;&quot;&quot;
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Gaming Laptop</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">1500</span><span>)
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Office Laptop</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">800</span><span>)
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Desk</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">300</span><span>)
</span><span>    
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;) + &#39;</span><span style="color:#a3be8c;">?search=laptop</span><span>&#39;
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), </span><span style="color:#d08770;">2</span><span>)
</span></code></pre>
<h3 id="testing-ordering">Testing Ordering</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_ordering</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API ordering&quot;&quot;&quot;
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">A Product</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">100</span><span>)
</span><span>    Product.objects.</span><span style="color:#bf616a;">create</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">B Product</span><span>&#39;, </span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">50</span><span>)
</span><span>    
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;) + &#39;</span><span style="color:#a3be8c;">?ordering=-price</span><span>&#39;
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[</span><span style="color:#d08770;">0</span><span>][&#39;</span><span style="color:#a3be8c;">price</span><span>&#39;], </span><span style="color:#d08770;">100</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[</span><span style="color:#d08770;">1</span><span>][&#39;</span><span style="color:#a3be8c;">price</span><span>&#39;], </span><span style="color:#d08770;">50</span><span>)
</span></code></pre>
<h3 id="testing-file-uploads">Testing File Uploads</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>django.core.files.uploadedfile </span><span style="color:#b48ead;">import </span><span>SimpleUploadedFile
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_image_upload</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test uploading an image&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    image = </span><span style="color:#bf616a;">SimpleUploadedFile</span><span>(
</span><span>        &quot;</span><span style="color:#a3be8c;">test_image.jpg</span><span>&quot;,
</span><span>        </span><span style="color:#b48ead;">b</span><span>&quot;</span><span style="color:#a3be8c;">file_content</span><span>&quot;,
</span><span>        </span><span style="color:#bf616a;">content_type</span><span>=&quot;</span><span style="color:#a3be8c;">image/jpeg</span><span>&quot;
</span><span>    )
</span><span>    data = {
</span><span>        &#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Product with Image</span><span>&#39;,
</span><span>        &#39;</span><span style="color:#a3be8c;">price</span><span>&#39;: </span><span style="color:#d08770;">100</span><span>,
</span><span>        &#39;</span><span style="color:#a3be8c;">image</span><span>&#39;: image
</span><span>    }
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, data, </span><span style="color:#bf616a;">format</span><span>=&#39;</span><span style="color:#a3be8c;">multipart</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_201_CREATED</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertTrue</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">image</span><span>&#39;])
</span></code></pre>
<h3 id="testing-rate-limiting">Testing Rate Limiting</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_rate_limiting</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API rate limiting&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    
</span><span>    </span><span style="color:#65737e;"># Make requests up to the limit
</span><span>    </span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(</span><span style="color:#d08770;">100</span><span>):
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>        </span><span style="color:#b48ead;">if </span><span>i &lt; </span><span style="color:#d08770;">99</span><span>:
</span><span>            </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    
</span><span>    </span><span style="color:#65737e;"># Next request should be throttled
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_429_TOO_MANY_REQUESTS</span><span>)
</span></code></pre>
<h3 id="using-mocks">Using Mocks</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>unittest.mock </span><span style="color:#b48ead;">import </span><span>patch, Mock
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">ExternalAPITestCase</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">APITestCase</span><span style="color:#eff1f5;">):
</span><span>    @</span><span style="color:#bf616a;">patch</span><span>(&#39;</span><span style="color:#a3be8c;">myapp.services.external_api_call</span><span>&#39;)
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_with_mocked_external_api</span><span>(</span><span style="color:#bf616a;">self</span><span>, </span><span style="color:#bf616a;">mock_api</span><span>):
</span><span>        </span><span style="color:#65737e;">&quot;&quot;&quot;Test functionality that depends on external APIs&quot;&quot;&quot;
</span><span>        mock_api.return_value = {&#39;</span><span style="color:#a3be8c;">status</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">success</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">data</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">test</span><span>&#39;}
</span><span>        
</span><span>        url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">process-external-data</span><span>&#39;)
</span><span>        response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, {&#39;</span><span style="color:#a3be8c;">id</span><span>&#39;: </span><span style="color:#d08770;">123</span><span>})
</span><span>        
</span><span>        </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>        mock_api.</span><span style="color:#bf616a;">assert_called_once_with</span><span>(</span><span style="color:#d08770;">123</span><span>)
</span></code></pre>
<h2 id="8-best-practices">8. Best Practices</h2>
<h3 id="organization">Organization</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Organize tests in a tests directory
</span><span>myapp/
</span><span>    tests/
</span><span>        </span><span style="color:#96b5b4;">__init__</span><span>.py
</span><span>        test_models.py
</span><span>        test_serializers.py
</span><span>        test_views.py
</span><span>        test_permissions.py
</span></code></pre>
<h3 id="use-factories-for-test-data">Use Factories for Test Data</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>factory
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">UserFactory</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">factory.django.DjangoModelFactory</span><span style="color:#eff1f5;">):
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Meta</span><span style="color:#eff1f5;">:
</span><span>        model = User
</span><span>    
</span><span>    username = factory.</span><span style="color:#bf616a;">Sequence</span><span>(</span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">n</span><span>: </span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">user</span><span>{n}&#39;)
</span><span>    email = factory.</span><span style="color:#bf616a;">LazyAttribute</span><span>(</span><span style="color:#b48ead;">lambda </span><span style="color:#bf616a;">obj</span><span>: </span><span style="color:#b48ead;">f</span><span>&#39;{obj.username}</span><span style="color:#a3be8c;">@example.com</span><span>&#39;)
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">ProductFactory</span><span style="color:#eff1f5;">(</span><span style="color:#a3be8c;">factory.django.DjangoModelFactory</span><span style="color:#eff1f5;">):
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Meta</span><span style="color:#eff1f5;">:
</span><span>        model = Product
</span><span>    
</span><span>    name = factory.</span><span style="color:#bf616a;">Faker</span><span>(&#39;</span><span style="color:#a3be8c;">word</span><span>&#39;)
</span><span>    price = factory.</span><span style="color:#bf616a;">Faker</span><span>(&#39;</span><span style="color:#a3be8c;">pydecimal</span><span>&#39;, </span><span style="color:#bf616a;">left_digits</span><span>=</span><span style="color:#d08770;">4</span><span>, </span><span style="color:#bf616a;">right_digits</span><span>=</span><span style="color:#d08770;">2</span><span>, </span><span style="color:#bf616a;">positive</span><span>=</span><span style="color:#d08770;">True</span><span>)
</span><span>
</span><span style="color:#65737e;"># Usage in tests
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_with_factory</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    user = </span><span style="color:#bf616a;">UserFactory</span><span>()
</span><span>    product = </span><span style="color:#bf616a;">ProductFactory</span><span>(</span><span style="color:#bf616a;">price</span><span>=</span><span style="color:#d08770;">100</span><span>)
</span></code></pre>
<h3 id="test-coverage">Test Coverage</h3>
<p>Run tests with coverage:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># Install coverage
</span><span style="color:#bf616a;">pip</span><span> install coverage
</span><span>
</span><span style="color:#65737e;"># Run tests with coverage
</span><span style="color:#bf616a;">coverage</span><span> run</span><span style="color:#bf616a;"> --source</span><span>=&#39;</span><span style="color:#a3be8c;">.</span><span>&#39; manage.py test
</span><span>
</span><span style="color:#65737e;"># Generate report
</span><span style="color:#bf616a;">coverage</span><span> report
</span><span style="color:#bf616a;">coverage</span><span> html  </span><span style="color:#65737e;"># Creates htmlcov/index.html
</span></code></pre>
<h3 id="common-assertions">Common Assertions</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Status codes
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>
</span><span style="color:#65737e;"># Data presence
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIn</span><span>(&#39;</span><span style="color:#a3be8c;">key</span><span>&#39;, response.data)
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertNotIn</span><span>(&#39;</span><span style="color:#a3be8c;">sensitive_field</span><span>&#39;, response.data)
</span><span>
</span><span style="color:#65737e;"># Data values
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;], &#39;</span><span style="color:#a3be8c;">Expected Name</span><span>&#39;)
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertTrue</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">is_active</span><span>&#39;])
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertIsNone</span><span>(response.data[&#39;</span><span style="color:#a3be8c;">deleted_at</span><span>&#39;])
</span><span>
</span><span style="color:#65737e;"># Collections
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), </span><span style="color:#d08770;">5</span><span>)
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertGreater</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), </span><span style="color:#d08770;">0</span><span>)
</span><span>
</span><span style="color:#65737e;"># Database state
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(Product.objects.</span><span style="color:#bf616a;">count</span><span>(), </span><span style="color:#d08770;">1</span><span>)
</span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertTrue</span><span>(Product.objects.</span><span style="color:#bf616a;">filter</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">Test</span><span>&#39;).</span><span style="color:#bf616a;">exists</span><span>())
</span></code></pre>
<h3 id="testing-edge-cases">Testing Edge Cases</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_empty_list</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test API returns empty list when no data exists&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_200_OK</span><span>)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(</span><span style="color:#96b5b4;">len</span><span>(response.data), </span><span style="color:#d08770;">0</span><span>)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_nonexistent_resource</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test 404 for nonexistent resources&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-detail</span><span>&#39;, </span><span style="color:#bf616a;">kwargs</span><span>={&#39;</span><span style="color:#a3be8c;">pk</span><span>&#39;: </span><span style="color:#d08770;">99999</span><span>})
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_404_NOT_FOUND</span><span>)
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_duplicate_creation</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>    </span><span style="color:#65737e;">&quot;&quot;&quot;Test handling of duplicate entries&quot;&quot;&quot;
</span><span>    url = </span><span style="color:#bf616a;">reverse</span><span>(&#39;</span><span style="color:#a3be8c;">product-list</span><span>&#39;)
</span><span>    data = {&#39;</span><span style="color:#a3be8c;">name</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">Unique Product</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">sku</span><span>&#39;: &#39;</span><span style="color:#a3be8c;">UNIQUE123</span><span>&#39;}
</span><span>    
</span><span>    </span><span style="color:#65737e;"># First creation should succeed
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_201_CREATED</span><span>)
</span><span>    
</span><span>    </span><span style="color:#65737e;"># Duplicate should fail
</span><span>    response = </span><span style="color:#bf616a;">self</span><span>.client.</span><span style="color:#bf616a;">post</span><span>(url, data)
</span><span>    </span><span style="color:#bf616a;">self</span><span>.</span><span style="color:#bf616a;">assertEqual</span><span>(response.status_code, status.</span><span style="color:#bf616a;">HTTP_400_BAD_REQUEST</span><span>)
</span></code></pre>
<h3 id="running-tests">Running Tests</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># Run all tests
</span><span style="color:#bf616a;">python</span><span> manage.py test
</span><span>
</span><span style="color:#65737e;"># Run specific app tests
</span><span style="color:#bf616a;">python</span><span> manage.py test myapp
</span><span>
</span><span style="color:#65737e;"># Run specific test class
</span><span style="color:#bf616a;">python</span><span> manage.py test myapp.tests.test_views.ProductAPITestCase
</span><span>
</span><span style="color:#65737e;"># Run specific test method
</span><span style="color:#bf616a;">python</span><span> manage.py test myapp.tests.test_views.ProductAPITestCase.test_create_product
</span><span>
</span><span style="color:#65737e;"># Run with verbosity
</span><span style="color:#bf616a;">python</span><span> manage.py test</span><span style="color:#bf616a;"> --verbosity</span><span>=2
</span><span>
</span><span style="color:#65737e;"># Keep test database
</span><span style="color:#bf616a;">python</span><span> manage.py test</span><span style="color:#bf616a;"> --keepdb
</span></code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Testing your Django REST Framework APIs ensures reliability, catches bugs early, and makes refactoring safer. Start with basic CRUD tests, then expand to cover authentication, permissions, edge cases, and business logic. Aim for high test coverage while focusing on meaningful tests that verify actual functionality.</p>
<p>Remember: good tests are readable, maintainable, and test one thing at a time. Happy testing!</p>
</section>
  <hr />
  <!-- Post Taxonomies -->

  <!-- Begin Page End inject -->
  
  <!-- End Page End inject -->
</article>

  </main>
  <!-- Footer -->
<footer class="mx-auto flex lg:mt-5 max-w-3xl flex-wrap items-center px-4 py-3 text-sm opacity-60">
  <div class="mr-auto basis-full lg:basis-1/2">
   <time datetime="2025">2025</time> HajMousa | <a href="https://creativecommons.org/licenses/by-sa/4.0/deed">CC BY-SA 4.0</a>
  </div>
  <div class="flex basis-full lg:basis-1/2 lg:justify-end">
    <span class="mr-6 lg:ml-6">
      <a class="link" href="https://www.getzola.org/" target="_blank">Powered by Zola</a>
    </span>
    <a class="link" href="https://www.getzola.org/themes/linkita/" target="_blank">&#9998; Linkita</a>
  </div>
  <!-- Begin Footer inject -->
  
  <!-- End Footer inject -->
</footer>

  
  <link rel="stylesheet" href="https://blog.hajmousa.ir/katex/katex.min.css?h=e189fd0238811989c364" />
  <script defer src="https://blog.hajmousa.ir/katex/katex.min.js?h=6b909443e6c8f6e5d24c"></script>
  <script defer src="https://blog.hajmousa.ir/katex/contrib/auto-render.min.js?h=bb53eb953394531aae36"></script>
  <script>document.addEventListener("DOMContentLoaded", window.zolaTheme.katex.init);</script>

  <!-- Begin Body End inject -->
  
  <!-- End Body End inject -->
</body>

</html>
